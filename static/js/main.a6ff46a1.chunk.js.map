{"version":3,"sources":["utils.js","components/ImageList.js","components/ImagePopUp.js","constants.js","App.js","index.js"],"names":["scrollAreaAvailable","undefined","window","pageYOffset","document","documentElement","body","parentNode","scrollTop","html","Math","max","scrollHeight","offsetHeight","clientHeight","getDocumentHeight","innerHeight","checkHttpStatus","response","status","parseJSON","json","getImageUrl","farm","server","id","secret","ImageList","props","onImageClick","bind","idx","this","image","onClick","className","src","alt","width","images","map","renderImageItem","React","Component","PopUpImage","state","showMeta","evt","stopPropagation","setState","title","onHide","style","marginTop","margin","constants","BASE_URL","STORAGE_KEY","App","queriesFromStorage","JSON","parse","localStorage","getItem","searchText","imageList","pageNumber","showPopUp","popUpImage","queries","onSearchInputChange","handleImageClick","onPopUpHide","handleScroll","onscroll","fn","threshhold","scope","last","deferTimer","context","now","Date","args","arguments","clearTimeout","setTimeout","apply","throttle","makeDebouncedSearch","func","wait","immediate","timeout","later","callNow","debounce","push","updateLocalStorage","url","fetch","then","resp","photos","photo","catch","err","console","log","setItem","stringify","currentTarget","value","trimmedText","replace","length","forEach","page","type","onChange","marginBottom","query","ref","transitionName","transitionEnterTimeout","transitionLeaveTimeout","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.a6ff46a1.chunk.js","sourcesContent":["\nfunction getDocumentHeight() {\n\tconst body = document.body;\n\tconst html = document.documentElement;\n\n\treturn Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight);\n}\n\n\nfunction getScrollTop() {\n\treturn window.pageYOffset !== undefined\n\t\t? window.pageYOffset\n\t\t: (document.documentElement || document.body.parentNode || document.body).scrollTop;\n}\n\n\nexport function scrollAreaAvailable() {\n\treturn getScrollTop() < getDocumentHeight() - window.innerHeight;\n}\n\nexport function debounce(func, wait, immediate) {\n\tvar timeout;\n\treturn function() {\n\t\tvar context = this,\n\t\t\targs = arguments;\n\t\tvar later = function() {\n\t\t\ttimeout = null;\n\t\t\tif (!immediate) func.apply(context, args);\n\t\t};\n\t\tvar callNow = immediate && !timeout;\n\t\tclearTimeout(timeout);\n\t\ttimeout = setTimeout(later, wait);\n\t\tif (callNow) func.apply(context, args);\n\t};\n}\n\nexport function throttle(fn, threshhold, scope) {\n\tthreshhold || (threshhold = 250);\n\tvar last, deferTimer;\n\treturn function() {\n\t\tvar context = scope || this;\n\t\tvar now = new Date(),\n\t\t\targs = arguments;\n\t\tif (last && now < last + threshhold) {\n\t\t\t// hold on to it\n\t\t\tclearTimeout(deferTimer);\n\t\t\tdeferTimer = setTimeout(function() {\n\t\t\t\tlast = now;\n\t\t\t\tfn.apply(context, args);\n\t\t\t}, threshhold);\n\t\t} else {\n\t\t\tlast = now;\n\t\t\tfn.apply(context, args);\n\t\t}\n\t};\n}\n\nexport function checkHttpStatus(response) {\n\tif (response.status >= 200 && response.status < 300) {\n\t\treturn response;\n\t} else {\n\t\tthrow response;\n\t}\n}\n\nexport function parseJSON(response) {\n\treturn response.json();\n}\n\n\nexport function getImageUrl(farm, server, id, secret) {\n\treturn `https://farm${farm}.staticflickr.com/${server}/${id}_${secret}.jpg`;\n}\n","import React from \"react\";\nimport { getImageUrl } from \"../utils.js\";\n\nexport default class ImageList extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.onImageClick = this.onImageClick.bind(this);\n\t}\n\n\tonImageClick(idx) {\n\t\tthis.props.onImageClick(idx);\n\t}\n\n\trenderImageItem(image, idx, onClick) {\n\t\tconst { farm, server, id, secret } = image;\n\t\treturn (\n\t\t\t<li key={idx} className=\"image-item\" onClick={() => onClick(idx)}>\n\t\t\t\t<img src={getImageUrl(farm, server, id, secret)} alt=\"\" width=\"300px\" />\n\t\t\t</li>\n\t\t);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<ul className=\"h-flex sb\">\n\t\t\t\t{this.props.images.map((image, idx) => this.renderImageItem(image, idx, this.onImageClick))}\n\t\t\t</ul>\n\t\t);\n\t}\n}\n","import React from \"react\";\nimport { getImageUrl } from \"../utils.js\";\n\nexport default class PopUpImage extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tshowMeta: false\n\t\t};\n\t\tthis.onImageClick = this.onImageClick.bind(this);\n\t}\n\n\tonImageClick(evt) {\n\t\tevt.stopPropagation();\n\t\tthis.setState({ showMeta: !this.state.showMeta });\n\t}\n\n\trender() {\n\t\tconst { title, farm, server, id, secret } = this.props.image;\n\t\treturn (\n\t\t\t<div className=\"image-popup-container\" onClick={this.props.onHide}>\n\t\t\t\t<img\n\t\t\t\t\tclassName=\"popup-image\"\n\t\t\t\t\tsrc={getImageUrl(farm, server, id, secret)}\n\t\t\t\t\talt=\"\"\n\t\t\t\t\tstyle={{ marginTop: \"140px\" }}\n\t\t\t\t\tonClick={this.onImageClick}\n\t\t\t\t/>\n\t\t\t\t{this.state.showMeta &&\n\t\t\t\t\t<ul className=\"image-metadata\">\n\t\t\t\t\t\t<li style={{ margin: \"5px 0\" }}>\n\t\t\t\t\t\t\tTitle: {title}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li style={{ margin: \"5px 0\" }}>\n\t\t\t\t\t\t\tImageId: {id}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li style={{ margin: \"5px 0\" }}>\n\t\t\t\t\t\t\tFarmId: {farm}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li style={{ margin: \"5px 0\" }}>\n\t\t\t\t\t\t\tServerId: {server}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li style={{ margin: \"5px 0\" }}>\n\t\t\t\t\t\t\tSecretId: {secret}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>}\n\t\t\t</div>\n\t\t);\n\t}\n}\n","const constants = {\n\tBASE_URL:\n\t\t\"https://api.flickr.com/services/rest/?method=flickr.photos.search&format=json&nojsoncallback=1&api_key=847b43221e688059973358acc1294ba5&per_page=20\",\n\tSTORAGE_KEY: \"flicker_search_queries\"\n};\n\nexport default constants;\n","import React from \"react\";\nimport \"./App.css\";\nimport ReactCSSTransitionGroup from \"react-addons-css-transition-group\";\nimport ImageList from \"./components/ImageList.js\";\nimport ImagePopUp from \"./components/ImagePopUp.js\";\nimport constants from \"./constants.js\";\nimport { scrollAreaAvailable, debounce, throttle, checkHttpStatus, parseJSON } from \"./utils.js\";\n\nexport default class App extends React.Component {\n\t\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst queriesFromStorage = JSON.parse(localStorage.getItem(constants.STORAGE_KEY));\n\t\tthis.state = {\n\t\t\tsearchText: \"\",\n\t\t\timageList: [],\n\t\t\tpageNumber: 1,\n\t\t\tshowPopUp: false,\n\t\t\tpopUpImage: null,\n\t\t\tqueries: queriesFromStorage ? queriesFromStorage : []\n\t\t};\n\t\t// Function bindings\n\t\tthis.onSearchInputChange = this.onSearchInputChange.bind(this);\n\t\tthis.handleImageClick = this.handleImageClick.bind(this);\n\t\tthis.onPopUpHide = this.onPopUpHide.bind(this);\n\t\tthis.handleScroll = this.handleScroll.bind(this);\n\t}\n\n\n\tcomponentDidMount() {\n\t\t/* Throttled scroll listener for infinite scrolling */\n\t\twindow.onscroll = throttle(() => {\n\t\t\tif (scrollAreaAvailable()) return;\n\t\t\tthis.handleScroll();\n\t\t}, 1000);\n\n\t\t/* Debounced function for search based on input text to mimimize network request on every character typed */\n\t\tthis.makeDebouncedSearch = debounce(() => {\n\t\t\t/* Save search query */\n\t\t\tthis.state.queries.push(this.state.searchText);\n\t\t\tthis.setState({ queries: this.state.queries }, this.updateLocalStorage());\n\n\t\t\t/* Make API call for the query */\n\t\t\tconst url = constants.BASE_URL + \"&text=\" + this.state.searchText;\n\t\t\tfetch(url)\n\t\t\t\t.then(checkHttpStatus)\n\t\t\t\t.then(parseJSON)\n\t\t\t\t.then(resp => {\n\t\t\t\t\tthis.setState({ imageList: resp.photos.photo });\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tconsole.log(err);\n\t\t\t\t});\n\t\t}, 1000);\n\t}\n\tupdateLocalStorage() {\n\t\tlocalStorage.setItem(constants.STORAGE_KEY, JSON.stringify(this.state.queries));\n\t}\n\n\tonSearchInputChange(evt) {\n\t\tconst searchText = evt.currentTarget.value;\n\t\tthis.setState({ searchText });\n\t\tconst trimmedText = searchText.replace(/\\s+$/, \"\");\n\t\tif (trimmedText.length) this.makeDebouncedSearch(trimmedText);\n\t}\n\n\thandleScroll() {\n\t\tlet url = constants.BASE_URL + \"&text=\" + this.state.searchText + \"&page=\" + (this.state.pageNumber + 1);\n\t\tfetch(url)\n\t\t\t.then(checkHttpStatus)\n\t\t\t.then(parseJSON)\n\t\t\t.then(resp => {\n\t\t\t\tresp.photos.photo.forEach(photo => this.state.imageList.push(photo));\n\t\t\t\tthis.setState({\n\t\t\t\t\tpageNumber: resp.photos.page,\n\t\t\t\t\timageList: this.state.imageList\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.log(err);\n\t\t\t});\n\t}\n\n\thandleImageClick(idx) {\n\t\tthis.setState({ popUpImage: this.state.imageList[idx] });\n\t}\n\n\tonPopUpHide() {\n\t\tthis.setState({ popUpImage: null });\n\t}\n\t\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"app\">\n\t\t\t\t<div className=\"app-header\">\n\t\t\t\t\t<h2 style={{ margin: \"1rem 0\" }}>Flickr Search</h2>\n\t\t\t\t\t<div className=\"h-flex jc ac search-bar\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tclassName=\"search-input\"\n\t\t\t\t\t\t\tvalue={this.state.searchText}\n\t\t\t\t\t\t\tonChange={this.onSearchInputChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t{this.state.queries.length > 0 &&\n\t\t\t\t\t\t<div style={{ marginTop: \"16px\" }}>\n\t\t\t\t\t\t\t<h5 style={{ marginBottom: \"5px\" }}>Recent Searches</h5>\n\t\t\t\t\t\t\t<ul className=\"h-flex jc\">\n\t\t\t\t\t\t\t\t{this.state.queries.map((query, idx) =>\n\t\t\t\t\t\t\t\t\t<li key={idx} className=\"query\">\n\t\t\t\t\t\t\t\t\t\t{query}\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"app-content\" ref=\"appContent\">\n\t\t\t\t\t{this.state.imageList.length\n\t\t\t\t\t\t? <ImageList images={this.state.imageList} onImageClick={this.handleImageClick} />\n\t\t\t\t\t\t: <p style={{ margin: \"1rem 0\" }}>Try searching for some image in the search bar</p>}\n\t\t\t\t\t<ReactCSSTransitionGroup\n\t\t\t\t\t\ttransitionName=\"popup-container\"\n\t\t\t\t\t\ttransitionEnterTimeout={400}\n\t\t\t\t\t\ttransitionLeaveTimeout={200}\n\t\t\t\t\t>\n\t\t\t\t\t\t{this.state.popUpImage &&\n\t\t\t\t\t\t\t<ImagePopUp image={this.state.popUpImage} onHide={this.onPopUpHide} />}\n\t\t\t\t\t</ReactCSSTransitionGroup>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tcomponentWillUnmount() {\n\t\t// Remove the listener for cleanup\n\t\twindow.onscroll = undefined;\n\t}\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}